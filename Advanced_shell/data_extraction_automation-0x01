#!/bin/bash

# data_extraction_automation-0x01
# Robust solution with exact output format

# Define the exact output template
read -r -d '' OUTPUT_TEMPLATE << 'EOF'
%s is of type %s, weighs %skg, and is %sm tall.
EOF

# Ensure we have data
if [[ ! -f "data.json" ]] || ! jq -e . data.json >/dev/null 2>&1; then
    curl -s "https://pokeapi.co/api/v2/pokemon/pikachu" -o data.json || exit 1
fi

# Extract values
name=$(jq -r '.name' data.json)
raw_weight=$(jq -r '.weight/10' data.json)
raw_height=$(jq -r '.height/10' data.json)
type=$(jq -r '.types[0].type.name' data.json)

# Process values
# Remove trailing .0 if present
weight=$(printf "%g" "$raw_weight")
height=$(printf "%g" "$raw_height")

# Capitalize type
type=$(echo "$type" | sed 's/^./\u&/')

# Output in exact format
printf "$OUTPUT_TEMPLATE\n" "$name" "$type" "$weight" "$height"
